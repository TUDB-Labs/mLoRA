name: Test LLM Models on Dev

on:
  push:
    branches:
      - '*'
  pull_request:
    branches:
      - '*'
jobs:
  test-llama-7b:
    runs-on: self-hosted
    steps:
      - name: clone repository
        run: |
          current_branch="${{ steps.branch_name.outputs.branch }}"
          cd /workspace
          rm -rf ./multi-lora-fine-tune
          git clone -b $current_branch --single-branch git@github.com:TUDB-Labs/multi-lora-fine-tune.git
      - name: test llama-7b
        run: |
          cd /workspace/multi-lora-fine-tune
          python mlora.py --base_model /data/llama-7b-hf --config ./config/finetune.json --load_8bit

#  test-vicuna-7b:
#    runs-on: self-hosted
#    steps:
#      - name: clone repository
#        run: |
#          cd /workspace
#          rm -rf ./multi-lora-fine-tune
#          git clone -b ${{ steps.branch_name.outputs.branch }} --single-branch git@github.com:TUDB-Labs/multi-lora-fine-tune.git
#      - name: test vicuna-7b-v1.1
#        run: |
#          cd /workspace/multi-lora-fine-tune
#          python mlora.py --base_model /data/vicuna-7b-v1.1 --config ./config/finetune.json --load_8bit
